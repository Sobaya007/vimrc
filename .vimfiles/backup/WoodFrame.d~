module WoodFrame;

import model;
import sbylib;
import PlayerAnnounce;

class WoodFrame {
  Model model;
  alias model this;

  vec3 playerPos;

  this(string filePath, mat4 transform) {
    Material wakuMat = new Material;
    wakuMat.withMaterial = (custom,rc,u) {
      custom.setUniform!(3, "lightPos")((playerPos + vec3(0,5,0)).array);//[0, 20, 0]);
      custom.setUniform!(3, "cameraPos")(SbyWorld.currentCamera.getPos.array);
      rc.defaulting();
      u();
    };
    model = new Model(filePath, transform, wakuMat, ShaderStore.getShader("Waku"));

    PlayerAnnouncer.getInstance.addListener((info) {
        this.playerPos = info.pos;
        });
  }
}
