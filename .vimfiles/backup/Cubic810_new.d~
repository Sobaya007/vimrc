module enemy.characters.Cubic.Cubic810_new;

import enemy.base;
import sbylib;
import collision;

class Cubic810_new : Enemy {

  this(Octree tree,Material material = null){
    Init(tree,material);
  }


  private:
  //初期化
  void Init(Octree tree,Material material = null){

    if ( material  is null ){
      material = new Material;
      material.withMaterial = (d,rc,u) @nogc {
        rc.defaulting;
        rc.cullFace(false);
        u();
      };
    }

    uint[][6] indices_temp = [
      [4,5,0,1], //下
      [6,7,4,5], //手前
      [0,1,2,3], //奥
      [2,3,6,7], //上
      [5,7,1,3], //左
      [0,2,4,6]  //右
    ];
    //頂点の基とするもの
    vec4[] vertices_temp = [
      vec4(-1,-1,-1,1f),
      vec4(+1,-1,-1,1),
      vec4(-1,+1,-1,1),
      vec4(+1,+1,-1,1),
      vec4(-1,-1,1,1),
      vec4(+1,-1,1,1),
      vec4(-1,+1,1,1),
      vec4(+1,+1,1,1)
    ];

    //描画情報の初期化
    drawMat dm;
    with (dm){
      tex = new TextureObject(SbyWorld.rootPath ~ "Resource/traP.png");
      tc = [
        vec2(0,0),
        vec2(1,0),
        vec2(0,1),
        vec2(1,1)
      ];
      vertices = vertices_temp;
      indices = indices_temp;
      pos = this.getWorldMatrix();
      mat = material;
    }

    //キャラクターの生成
    this.builder.setVertices(vertices_temp,indices_temp)
      .setDrawer(dm)
      .setCollision(tree)
      .build();
  }


}
